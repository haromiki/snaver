xpro@xpro0:~/snaver$ pm2 logs snaver-api --lines 100
[TAILING] Tailing last 100 lines for [snaver-api] process (change the value with --lines option)
/srv/xpro0/.pm2/logs/snaver-api-error-0.log last 100 lines:
0|snaver-a |   position: '42',
0|snaver-a |   internalPosition: undefined,
0|snaver-a |   internalQuery: undefined,
0|snaver-a |   where: undefined,
0|snaver-a |   schema: undefined,
0|snaver-a |   table: undefined,
0|snaver-a |   column: undefined,
0|snaver-a |   dataType: undefined,
0|snaver-a |   constraint: undefined,
0|snaver-a |   file: 'parse_target.c',
0|snaver-a |   line: '1075',
0|snaver-a |   routine: 'checkInsertTargets'
0|snaver-a | }
0|snaver-a | 제품 추가 오류: error: column "product_name" of relation "products" does not exist
0|snaver-a |     at /srv/xpro0/snaver/node_modules/pg-pool/index.js:45:11
0|snaver-a |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|snaver-a |     at async file:///srv/xpro0/snaver/node_modules/drizzle-orm/node-postgres/session.js:83:22
0|snaver-a |     at async DatabaseStorage.createProduct (file:///srv/xpro0/snaver/dist/index.js:215:26)
0|snaver-a |     at async file:///srv/xpro0/snaver/dist/index.js:805:23 {
0|snaver-a |   length: 133,
0|snaver-a |   severity: 'ERROR',
0|snaver-a |   code: '42703',
0|snaver-a |   detail: undefined,
0|snaver-a |   hint: undefined,
0|snaver-a |   position: '42',
0|snaver-a |   internalPosition: undefined,
0|snaver-a |   internalQuery: undefined,
0|snaver-a |   where: undefined,
0|snaver-a |   schema: undefined,
0|snaver-a |   table: undefined,
0|snaver-a |   column: undefined,
0|snaver-a |   dataType: undefined,
0|snaver-a |   constraint: undefined,
0|snaver-a |   file: 'parse_target.c',
0|snaver-a |   line: '1075',
0|snaver-a |   routine: 'checkInsertTargets'
0|snaver-a | }
0|snaver-a | 로그인 오류: TypeError: Cannot read properties of undefined (reading 'select')
0|snaver-a |     at DatabaseStorage.getUserByUsername (file:///srv/xpro0/snaver/dist/index.js:178:29)
0|snaver-a |     at file:///srv/xpro0/snaver/dist/index.js:747:34
0|snaver-a |     at Layer.handle [as handle_request] (/srv/xpro0/snaver/node_modules/express/lib/router/layer.js:95:5)
0|snaver-a |     at next (/srv/xpro0/snaver/node_modules/express/lib/router/route.js:149:13)
0|snaver-a |     at Route.dispatch (/srv/xpro0/snaver/node_modules/express/lib/router/route.js:119:3)
0|snaver-a |     at Layer.handle [as handle_request] (/srv/xpro0/snaver/node_modules/express/lib/router/layer.js:95:5)
0|snaver-a |     at /srv/xpro0/snaver/node_modules/express/lib/router/index.js:284:15
0|snaver-a |     at Function.process_params (/srv/xpro0/snaver/node_modules/express/lib/router/index.js:346:12)
0|snaver-a |     at next (/srv/xpro0/snaver/node_modules/express/lib/router/index.js:280:10)
0|snaver-a |     at file:///srv/xpro0/snaver/dist/index.js:1154:3
0|snaver-a | 로그인 오류: TypeError: Cannot read properties of undefined (reading 'select')
0|snaver-a |     at DatabaseStorage.getUserByUsername (file:///srv/xpro0/snaver/dist/index.js:178:29)
0|snaver-a |     at file:///srv/xpro0/snaver/dist/index.js:747:34
0|snaver-a |     at Layer.handle [as handle_request] (/srv/xpro0/snaver/node_modules/express/lib/router/layer.js:95:5)
0|snaver-a |     at next (/srv/xpro0/snaver/node_modules/express/lib/router/route.js:149:13)
0|snaver-a |     at Route.dispatch (/srv/xpro0/snaver/node_modules/express/lib/router/route.js:119:3)
0|snaver-a |     at Layer.handle [as handle_request] (/srv/xpro0/snaver/node_modules/express/lib/router/layer.js:95:5)
0|snaver-a |     at /srv/xpro0/snaver/node_modules/express/lib/router/index.js:284:15
0|snaver-a |     at Function.process_params (/srv/xpro0/snaver/node_modules/express/lib/router/index.js:346:12)
0|snaver-a |     at next (/srv/xpro0/snaver/node_modules/express/lib/router/index.js:280:10)
0|snaver-a |     at file:///srv/xpro0/snaver/dist/index.js:1154:3
0|snaver-a | 로그인 오류: TypeError: Cannot read properties of undefined (reading 'select')
0|snaver-a |     at DatabaseStorage.getUserByUsername (file:///srv/xpro0/snaver/dist/index.js:178:29)
0|snaver-a |     at file:///srv/xpro0/snaver/dist/index.js:747:34
0|snaver-a |     at Layer.handle [as handle_request] (/srv/xpro0/snaver/node_modules/express/lib/router/layer.js:95:5)
0|snaver-a |     at next (/srv/xpro0/snaver/node_modules/express/lib/router/route.js:149:13)
0|snaver-a |     at Route.dispatch (/srv/xpro0/snaver/node_modules/express/lib/router/route.js:119:3)
0|snaver-a |     at Layer.handle [as handle_request] (/srv/xpro0/snaver/node_modules/express/lib/router/layer.js:95:5)
0|snaver-a |     at /srv/xpro0/snaver/node_modules/express/lib/router/index.js:284:15
0|snaver-a |     at Function.process_params (/srv/xpro0/snaver/node_modules/express/lib/router/index.js:346:12)
0|snaver-a |     at next (/srv/xpro0/snaver/node_modules/express/lib/router/index.js:280:10)
0|snaver-a |     at file:///srv/xpro0/snaver/dist/index.js:1151:3
0|snaver-a | OpenAPI 오류 (시도 1/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 2/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 3/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | API 호출 실패 (시도 3/3): OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 1/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 2/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 3/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | API 호출 실패 (시도 3/3): OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 1/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 2/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 3/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | API 호출 실패 (시도 3/3): OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | [organic] 치명적 오류 - inputId: "12167678468", keyword: "주차번호판"
0|snaver-a | [organic] 오류 상세: OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | [organic] 오류 스택: Error: OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a |     at callApi (file:///srv/xpro0/snaver/dist/index.js:396:21)
0|snaver-a |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|snaver-a |     at async fetchOrganicRank (file:///srv/xpro0/snaver/dist/index.js:414:20)
0|snaver-a |     at async file:///srv/xpro0/snaver/dist/index.js:915:22
0|snaver-a | OpenAPI 오류 (시도 1/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 2/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 3/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | API 호출 실패 (시도 3/3): OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | [organic] 치명적 오류 - inputId: "5020450545", keyword: "주차번호판"
0|snaver-a | [organic] 오류 상세: OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | [organic] 오류 스택: Error: OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a |     at callApi (file:///srv/xpro0/snaver/dist/index.js:396:21)
0|snaver-a |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|snaver-a |     at async fetchOrganicRank (file:///srv/xpro0/snaver/dist/index.js:414:20)
0|snaver-a |     at async file:///srv/xpro0/snaver/dist/index.js:915:22

/srv/xpro0/.pm2/logs/snaver-api-out-0.log last 100 lines:
0|snaver-a | 1:10:26 PM [express] POST /api/products/5/refresh 200 in 215ms :: {"success":true,"message":"순위 업데이트…
0|snaver-a | 1:10:26 PM [express] GET /api/products 200 in 8ms :: [{"id":5,"userId":1,"productName":"두플Q 크리스탈","p…
0|snaver-a | 1:10:26 PM [express] GET /api/products 200 in 103ms :: [{"id":5,"userId":1,"productName":"두플Q 크리스탈",…
0|snaver-a | ✅ VITE_IS_SERVER_DEPLOY (raw): true
0|snaver-a | ✅ VITE_IS_SERVER_DEPLOY (raw): true
0|snaver-a | ✅ TYPEOF: string
0|snaver-a | [dotenv@17.2.1] injecting env (3) from .env -- tip: 🔐 prevent building .env in docker: https://dotenvx.com/prebuild
0|snaver-a | 1:15:39 PM [express] serving on port 3000
0|snaver-a | 1:15:41 PM [express] GET /api/_health 200 in 97ms :: {"ok":true,"service":"snaver-api"}
0|snaver-a | ✅ Using pg + drizzle on server
0|snaver-a | 1:15:45 PM [express] GET /api/_health 200 in 1ms :: {"ok":true,"service":"snaver-api"}
0|snaver-a | 1:15:47 PM [express] GET /api/_health 200 in 1ms :: {"ok":true,"service":"snaver-api"}
0|snaver-a | 1:15:49 PM [express] GET /api/auth/me 401 in 1ms :: {"message":"토큰이 필요합니다"}
0|snaver-a | 1:15:57 PM [express] GET /api/auth/me 200 in 903ms :: {"id":1,"username":"test","email":"haromiki@gm…
0|snaver-a | 1:15:57 PM [express] GET /api/products 200 in 105ms :: []
0|snaver-a | 1:15:58 PM [express] GET /api/products 200 in 203ms :: [{"id":5,"userId":1,"productName":"두플Q 크리스탈",…
0|snaver-a | [organic] 시작: "주차번호판", inputId=12167678468
0|snaver-a | 1:16:03 PM [express] POST /api/products/5/refresh 200 in 1508ms :: {"success":true,"message":"순위 업데이…
0|snaver-a | 1:16:09 PM [express] GET /api/products 200 in 107ms :: [{"id":5,"userId":1,"productName":"두플Q 크리스탈",…
0|snaver-a | 1:16:10 PM [express] GET /api/products 200 in 301ms :: [{"id":5,"userId":1,"productName":"두플Q 크리스탈",…
0|snaver-a | 1:21:35 PM [express] GET /api/auth/me 200 in 99ms :: {"id":1,"username":"test","email":"haromiki@gma…
0|snaver-a | 1:21:35 PM [express] GET /api/products 200 in 6ms :: []
0|snaver-a | 1:21:36 PM [express] GET /api/products 200 in 6ms :: [{"id":5,"userId":1,"productName":"두플Q 크리스탈","p…
0|snaver-a | ✅ VITE_IS_SERVER_DEPLOY (raw): true
0|snaver-a | ✅ VITE_IS_SERVER_DEPLOY (raw): true
0|snaver-a | ✅ TYPEOF: string
0|snaver-a | [dotenv@17.2.1] injecting env (3) from .env -- tip: 🔐 prevent building .env in docker: https://dotenvx.com/prebuild
0|snaver-a | 1:24:59 PM [express] serving on port 3000
0|snaver-a | ✅ Using pg + drizzle on server
0|snaver-a | 1:25:04 PM [express] GET /api/auth/me 401 in 100ms :: {"message":"토큰이 필요합니다"}
0|snaver-a | 1:25:14 PM [express] GET /api/auth/me 200 in 317ms :: {"id":1,"username":"test","email":"haromiki@gm…
0|snaver-a | 1:25:14 PM [express] GET /api/products 200 in 100ms :: []
0|snaver-a | 1:25:16 PM [express] GET /api/products 200 in 6ms :: [{"id":5,"userId":1,"productName":"두플Q 크리스탈","p…
0|snaver-a | [organic] 시작: "주차번호판", inputId=12167678468
0|snaver-a | 1:25:18 PM [express] POST /api/products/5/refresh 200 in 501ms :: {"success":true,"message":"순위 업데이트…
0|snaver-a | 1:25:27 PM [express] GET /api/products 200 in 8ms :: [{"id":5,"userId":1,"productName":"두플Q 크리스탈","p…
0|snaver-a | 1:26:14 PM [express] POST /api/products 200 in 101ms :: {"id":6,"userId":1,"productName":"아미티","prod…
0|snaver-a | 1:26:14 PM [express] GET /api/products 200 in 102ms :: [{"id":6,"userId":1,"productName":"아미티","prod…
0|snaver-a | [organic] 시작: "주차번호판", inputId=5020450545
0|snaver-a | 1:26:19 PM [express] POST /api/products/6/refresh 200 in 205ms :: {"success":true,"message":"순위 업데이트…
0|snaver-a | 1:26:28 PM [express] GET /api/products 200 in 105ms :: [{"id":6,"userId":1,"productName":"아미티","prod…
0|snaver-a | [organic] 시작: "주차번호판", inputId=5020450545
0|snaver-a | 1:30:04 PM [express] POST /api/products/6/refresh 200 in 299ms :: {"success":true,"message":"순위 업데이트…
0|snaver-a | 1:30:13 PM [express] GET /api/products 200 in 103ms :: [{"id":6,"userId":1,"productName":"아미티","prod…
0|snaver-a | [organic] 시작: "주차번호판", inputId=5020450545
0|snaver-a | 1:30:30 PM [express] POST /api/products/6/refresh 200 in 315ms :: {"success":true,"message":"순위 업데이트…
0|snaver-a | 1:30:40 PM [express] GET /api/products 200 in 201ms :: [{"id":6,"userId":1,"productName":"아미티","prod…
0|snaver-a | ✅ VITE_IS_SERVER_DEPLOY (raw): true
0|snaver-a | ✅ VITE_IS_SERVER_DEPLOY (raw): true
0|snaver-a | ✅ TYPEOF: string
0|snaver-a | [dotenv@17.2.1] injecting env (3) from .env -- tip: 🔐 prevent building .env in docker: https://dotenvx.com/prebuild
0|snaver-a | 1:36:43 PM [express] serving on port 3000
0|snaver-a | ✅ Using pg + drizzle on server
0|snaver-a | 1:36:50 PM [express] GET /api/auth/me 401 in 99ms :: {"message":"토큰이 필요합니다"}
0|snaver-a | 1:38:49 PM [express] GET /api/auth/me 200 in 213ms :: {"id":1,"username":"test","email":"haromiki@gm…
0|snaver-a | 1:38:49 PM [express] GET /api/products 200 in 7ms :: []
0|snaver-a | 1:38:51 PM [express] GET /api/products 200 in 104ms :: [{"id":6,"userId":1,"productName":"아미티","prod…
0|snaver-a | [organic] 시작: "주차번호판", inputId=5020450545
0|snaver-a | [organic] 실서버 환경 최적화 - clientId 존재: false, clientSecret 존재: false
0|snaver-a | [organic] 1차 배치 요청 중...
0|snaver-a | 1:38:56 PM [express] POST /api/products/6/refresh 200 in 913ms :: {"success":true,"message":"순위 업데이트…
0|snaver-a | 1:39:05 PM [express] GET /api/products 200 in 102ms :: [{"id":6,"userId":1,"productName":"아미티","prod…
0|snaver-a | [organic] 시작: "주차번호판", inputId=5020450545
0|snaver-a | [organic] 실서버 환경 최적화 - clientId 존재: false, clientSecret 존재: false
0|snaver-a | [organic] 1차 배치 요청 중...
0|snaver-a | 1:39:12 PM [express] POST /api/products/6/refresh 200 in 407ms :: {"success":true,"message":"순위 업데이트…
0|snaver-a | 1:39:21 PM [express] GET /api/products 200 in 100ms :: [{"id":6,"userId":1,"productName":"아미티","prod…
0|snaver-a | 1:39:31 PM [express] GET /api/auth/me 200 in 4ms :: {"id":1,"username":"test","email":"haromiki@gmai…
0|snaver-a | 1:39:31 PM [express] GET /api/products 200 in 4ms :: []
0|snaver-a | 1:39:32 PM [express] GET /api/products 200 in 17ms :: [{"id":6,"userId":1,"productName":"아미티","produ…
0|snaver-a | ✅ VITE_IS_SERVER_DEPLOY (raw): true
0|snaver-a | ✅ VITE_IS_SERVER_DEPLOY (raw): true
0|snaver-a | ✅ TYPEOF: string
0|snaver-a | [dotenv@17.2.1] injecting env (3) from .env -- tip: 📡 version env with Radar: https://dotenvx.com/radar
0|snaver-a | 1:48:45 PM [express] serving on port 3000
0|snaver-a | 1:48:46 PM [express] GET /api/_health 200 in 5ms :: {"ok":true,"service":"snaver-api"}
0|snaver-a | ✅ Using pg + drizzle on server
0|snaver-a | 1:48:47 PM [express] GET /api/_health 200 in 1ms :: {"ok":true,"service":"snaver-api"}
0|snaver-a | 1:48:48 PM [express] GET /api/auth/me 401 in 1ms :: {"message":"토큰이 필요합니다"}
0|snaver-a | 1:49:00 PM [express] GET /api/auth/me 200 in 505ms :: {"id":1,"username":"test","email":"haromiki@gm…
0|snaver-a | 1:49:00 PM [express] GET /api/products 200 in 106ms :: []
0|snaver-a | 1:49:01 PM [express] GET /api/products 200 in 19ms :: [{"id":6,"userId":1,"productName":"아미티","produ…
0|snaver-a | [organic] 시작: "주차번호판", inputId=12167678468
0|snaver-a | [organic] 실서버 환경 최적화 - clientId 존재: false, clientSecret 존재: false
0|snaver-a | [organic] 1차 배치 요청 중...
0|snaver-a | 1:49:05 PM [express] POST /api/products/5/refresh 200 in 815ms :: {"success":true,"message":"순위 업데이트…
0|snaver-a | 1:49:14 PM [express] GET /api/products 200 in 18ms :: [{"id":6,"userId":1,"productName":"아미티","produ…
0|snaver-a | [organic] 시작: "주차번호판", inputId=5020450545
0|snaver-a | [organic] 실서버 환경 최적화 - clientId 존재: false, clientSecret 존재: false
0|snaver-a | [organic] 1차 배치 요청 중...
0|snaver-a | 1:49:22 PM [express] POST /api/products/6/refresh 200 in 506ms :: {"success":true,"message":"순위 업데이트…
0|snaver-a | 1:49:30 PM [express] GET /api/products 200 in 101ms :: [{"id":6,"userId":1,"productName":"아미티","prod…
0|snaver-a | 1:49:36 PM [express] GET /api/auth/me 200 in 4ms :: {"id":1,"username":"test","email":"haromiki@gmai…
0|snaver-a | 1:49:36 PM [express] GET /api/products 200 in 5ms :: []
0|snaver-a | 1:49:37 PM [express] GET /api/auth/me 200 in 4ms :: {"id":1,"username":"test","email":"haromiki@gmai…
0|snaver-a | 1:49:38 PM [express] GET /api/products 200 in 4ms :: []
0|snaver-a | 1:49:38 PM [express] GET /api/products 200 in 7ms :: [{"id":6,"userId":1,"productName":"아미티","produc…
0|snaver-a | 1:49:40 PM [express] GET /api/auth/me 200 in 3ms :: {"id":1,"username":"test","email":"haromiki@gmai…
0|snaver-a | 1:49:40 PM [express] GET /api/products 200 in 5ms :: []
0|snaver-a | 1:49:41 PM [express] GET /api/products 200 in 6ms :: [{"id":6,"userId":1,"productName":"아미티","produc…

^C
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$ ps aux | grep node
xpro      316877  0.1  1.3 11573300 12968 ?      Ssl  Aug21   5:01 node /srv/xpro0/snaver/server/dist/index.js
xpro     2752750  4.6 10.2 22553700 99848 ?      Sl   13:48   0:15 node /srv/xpro0/snaver/dist/index.js
root     2757695 97.0  5.3 1003044 52608 ?       Ssl  13:54   0:00 node /srv/xpro0/svc/src/index.js
xpro     2757707  0.0  0.2   6480  2080 pts/4    S+   13:54   0:00 grep node
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$ sudo journalctl --since "30 minutes ago" | grep -E "\[organic\]|OpenAPI|API 호출"
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$ pm2 logs | grep -E "\[organic\]|OpenAPI|API 호출"
0|snaver-a | OpenAPI 오류 (시도 1/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 2/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | OpenAPI 오류 (시도 3/3): 401 {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | API 호출 실패 (시도 3/3): OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | [organic] 치명적 오류 - inputId: "5020450545", keyword: "주차번호판"
0|snaver-a | [organic] 오류 상세: OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | [organic] 오류 스택: Error: OpenAPI 401: {"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}
0|snaver-a | [organic] 시작: "주차번호판", inputId=5020450545
0|snaver-a | [organic] 실서버 환경 최적화 - clientId 존재: false, clientSecret 존재: false
0|snaver-a | [organic] 1차 배치 요청 중...
^C
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$ curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"usernameOrEmail":"your-username","password":"your-password"}'
{"message":"잘못된 로그인 정보입니다"}xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$ psql -U xpro -d snaver
Password for user xpro:
psql (14.18 (Ubuntu 14.18-0ubuntu0.22.04.1))
Type "help" for help.

snaver=> SELECT * FROM "User";
ERROR:  relation "User" does not exist
LINE 1: SELECT * FROM "User";
                      ^
snaver=> SELECT id, username, email, password FROM "User";
ERROR:  relation "User" does not exist
LINE 1: SELECT id, username, email, password FROM "User";
                                                  ^
snaver=> ^C
snaver=> \q
xpro@xpro0:~/snaver$  curl -X POST http://localhost:3000/api/auth/login \
>   -H "Content-Type: application/json" \
> d '{"haromiki@gmail.com":"test","Minari4027*":"Minari4027*"}'
{"message":"usernameOrEmail: Required, password: Required"}curl: (6) Could not resolve host: d

[1/2]: "haromiki@gmail.com":"test" --> <stdout>
--_curl_--"haromiki@gmail.com":"test"
curl: (3) URL using bad/illegal format or missing URL

[2/2]: "Minari4027*":"Minari4027*" --> <stdout>
--_curl_--"Minari4027*":"Minari4027*"
curl: (3) URL using bad/illegal format or missing URL
xpro@xpro0:~/snaver$ psql -U xpro -d snaver
Password for user xpro:
psql (14.18 (Ubuntu 14.18-0ubuntu0.22.04.1))
Type "help" for help.

snaver=> \dt
         List of relations
 Schema |   Name   | Type  | Owner
--------+----------+-------+-------
 public | products | table | xpro
 public | tracks   | table | xpro
 public | users    | table | xpro
(3 rows)

snaver=> curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser","email":"test@example.com","password":"test1234"}^C
snaver=> \q
xpro@xpro0:~/snaver$ curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"test","email":"haromiki@gmail.com","password":"Minari4027*"}'
{"message":"이미 존재하는 사용자입니다"}xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$ TOKEN="받은-토큰"
curl -X POST http://localhost:3000/api/products/ID/refresh \
  -H "Authorization: Bearer $TOKEN" \
  -v
*   Trying 127.0.0.1:3000...
* Connected to localhost (127.0.0.1) port 3000 (#0)
> POST /api/products/ID/refresh HTTP/1.1
> Host: localhost:3000
> User-Agent: curl/7.81.0
> Accept: */*
> Authorization: Bearer 받은-토큰
>
* Mark bundle as not supporting multiuse
< HTTP/1.1 403 Forbidden
< X-Powered-By: Express
< Content-Type: application/json; charset=utf-8
< Content-Length: 49
< ETag: W/"31-iANoEeFeSK7vLH+t+SHasrZfQb0"
< Date: Sat, 23 Aug 2025 05:02:25 GMT
< Connection: keep-alive
< Keep-Alive: timeout=5
<
* Connection #0 to host localhost left intact
{"message":"유효하지 않은 토큰입니다"}xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$ curl -v "https://openapi.naver.com/v1/search/shop.json?query=test&display=1" \
  -H "X-Naver-Client-Id: YOUR_CLIENT_ID" \
  -H "X-Naver-Client-Secret: YOUR_CLIENT_SECRET"
*   Trying 125.209.233.16:443...
* Connected to openapi.naver.com (125.209.233.16) port 443 (#0)
* ALPN, offering h2
* ALPN, offering http/1.1
*  CAfile: /etc/ssl/certs/ca-certificates.crt
*  CApath: /etc/ssl/certs
* TLSv1.0 (OUT), TLS header, Certificate Status (22):
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
* TLSv1.2 (IN), TLS header, Certificate Status (22):
* TLSv1.3 (IN), TLS handshake, Server hello (2):
* TLSv1.2 (IN), TLS header, Finished (20):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Certificate (11):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, CERT verify (15):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Finished (20):
* TLSv1.2 (OUT), TLS header, Finished (20):
* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.3 (OUT), TLS handshake, Finished (20):
* SSL connection using TLSv1.3 / TLS_AES_128_GCM_SHA256
* ALPN, server accepted to use h2
* Server certificate:
*  subject: C=KR; ST=Gyeonggi-do; L=Seongnam-si; O=NAVER Corp.; CN=*.naver.com
*  start date: Mar  5 00:00:00 2025 GMT
*  expire date: Mar 17 23:59:59 2026 GMT
*  subjectAltName: host "openapi.naver.com" matched cert's "*.naver.com"
*  issuer: C=US; O=DigiCert Inc; CN=DigiCert TLS Hybrid ECC SHA384 2020 CA1
*  SSL certificate verify ok.
* Using HTTP2, server supports multiplexing
* Connection state changed (HTTP/2 confirmed)
* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* Using Stream ID: 1 (easy handle 0x55f301c664b0)
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
> GET /v1/search/shop.json?query=test&display=1 HTTP/2
> Host: openapi.naver.com
> user-agent: curl/7.81.0
> accept: */*
> x-naver-client-id: YOUR_CLIENT_ID
> x-naver-client-secret: YOUR_CLIENT_SECRET
>
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
* old SSL session ID is stale, removing
* TLSv1.2 (IN), TLS header, Supplemental data (23):
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
* TLSv1.2 (IN), TLS header, Supplemental data (23):
< HTTP/2 401
< date: Sat, 23 Aug 2025 05:03:06 GMT
< content-type: application/json;charset=UTF-8
< content-length: 124
< apigw-uuid: 3fde18e8-c581-4e2b-bc26-3a27fb061969
< x-rate-limit: 10
< x-rate-limit-remaining: 9
< x-rate-limit-reset: 1755925387000
< apigw-error: 024
< referrer-policy: unsafe-url
< server: nfront
<
* Connection #0 to host openapi.naver.com left intact
{"errorMessage":"NID AUTH Result Invalid (1000) : Authentication failed. (인증에 실패했습니다.)","errorCode":"024"}xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$ nslookup openapi.naver.com
Server:         100.100.100.100
Address:        100.100.100.100#53

Non-authoritative answer:
openapi.naver.com       canonical name = d4b87330.ndash.net.
Name:   d4b87330.ndash.net
Address: 125.209.233.24
Name:   d4b87330.ndash.net
Address: 125.209.233.16

xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$ sudo iptables -L | grep 3000
xpro@xpro0:~/snaver$ sudo ufw status
Status: active

To                         Action      From
--                         ------      ----
OpenSSH                    ALLOW       Anywhere
21/tcp                     ALLOW       Anywhere
40000:40100/tcp            ALLOW       Anywhere
443                        ALLOW       Anywhere
80/tcp                     ALLOW       Anywhere
5432                       ALLOW       172.17.0.0/16
OpenSSH (v6)               ALLOW       Anywhere (v6)
21/tcp (v6)                ALLOW       Anywhere (v6)
40000:40100/tcp (v6)       ALLOW       Anywhere (v6)
443 (v6)                   ALLOW       Anywhere (v6)
80/tcp (v6)                ALLOW       Anywhere (v6)

xpro@xpro0:~/snaver$ sudo ufw allow 3000
Rule added
Rule added (v6)
xpro@xpro0:~/snaver$ sudo ufw status
Status: active

To                         Action      From
--                         ------      ----
OpenSSH                    ALLOW       Anywhere
21/tcp                     ALLOW       Anywhere
40000:40100/tcp            ALLOW       Anywhere
443                        ALLOW       Anywhere
80/tcp                     ALLOW       Anywhere
5432                       ALLOW       172.17.0.0/16
3000                       ALLOW       Anywhere
OpenSSH (v6)               ALLOW       Anywhere (v6)
21/tcp (v6)                ALLOW       Anywhere (v6)
40000:40100/tcp (v6)       ALLOW       Anywhere (v6)
443 (v6)                   ALLOW       Anywhere (v6)
80/tcp (v6)                ALLOW       Anywhere (v6)
3000 (v6)                  ALLOW       Anywhere (v6)

xpro@xpro0:~/snaver$ TOKEN="받은-토큰"
curl -X POST http://localhost:3000/api/products/ID/refresh \
  -H "Authorization: Bearer $TOKEN" \
  -v
*   Trying 127.0.0.1:3000...
* Connected to localhost (127.0.0.1) port 3000 (#0)
> POST /api/products/ID/refresh HTTP/1.1
> Host: localhost:3000
> User-Agent: curl/7.81.0
> Accept: */*
> Authorization: Bearer 받은-토큰
>
* Mark bundle as not supporting multiuse
< HTTP/1.1 403 Forbidden
< X-Powered-By: Express
< Content-Type: application/json; charset=utf-8
< Content-Length: 49
< ETag: W/"31-iANoEeFeSK7vLH+t+SHasrZfQb0"
< Date: Sat, 23 Aug 2025 05:04:46 GMT
< Connection: keep-alive
< Keep-Alive: timeout=5
<
* Connection #0 to host localhost left intact
{"message":"유효하지 않은 토큰입니다"}xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$
xpro@xpro0:~/snaver$